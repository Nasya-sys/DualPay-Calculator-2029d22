<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DualPay - Нася Цокова</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'app-pink': '#FFD1DC',
                        'app-green': '#90EE90',
                        'dark-green': '#2D5A27',
                    },
                    fontFamily: {
                        'comfortaa': ['Comfortaa', 'sans-serif'],
                        'montserrat': ['Montserrat', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #FFD1DC;
            margin: 0;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
            perspective: 1000px;
        }

        /* Динамичен фон: Стриктна шахматна мрежа */
        #bg-container {
            position: fixed;
            top: -10%; left: -10%; width: 120%; height: 120%;
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            z-index: -1;
            pointer-events: none;
        }

        .symbol {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 900;
            color: rgba(0, 0, 0, 0.25); /* Ясно открояващи се */
            animation: float 6s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg) scale(1); }
            33% { transform: translate(10px, -20px) rotate(5deg) scale(1.1); }
            66% { transform: translate(-10px, 15px) rotate(-5deg) scale(0.9); }
        }

        /* Стъклен ефект и дълбоки сенки */
        .glass-window {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 50px;
            box-shadow: 0 40px 80px rgba(0, 0, 0, 0.35);
            width: 90%;
            max-width: 420px;
            padding: 2.5rem;
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        /* Сегментиран бутон */
        .segmented-btn.active {
            background-color: #90EE90;
            color: #2D5A27;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

    <div id="bg-container"></div>

    <main class="glass-window flex flex-col gap-6">
        
        <div class="flex flex-col items-center">
            <div class="w-24 h-24 bg-app-pink rounded-[30px] flex items-center justify-center shadow-2xl border-4 border-app-green mb-2">
                <span class="font-comfortaa text-2xl text-dark-green">€ ⇄ лв</span>
            </div>
            <h1 class="font-comfortaa text-xl font-bold text-gray-800">DualPay</h1>
        </div>

        <div class="space-y-4">
            <div>
                <label class="block text-[11px] font-bold text-gray-600 mb-1 ml-2">СУМА ЗА ПЛАЩАНЕ</label>
                <div class="flex gap-2">
                    <input type="number" id="bill" placeholder="0.00" 
                        class="flex-1 bg-app-green p-4 rounded-3xl text-3xl font-bold text-dark-green outline-none shadow-inner">
                    <div class="flex bg-white/30 rounded-3xl p-1 shadow-md border border-white/40">
                        <button onclick="setBillCurr('BGN')" id="bBgn" class="px-4 rounded-2xl font-bold transition-all bg-app-green text-dark-green shadow-sm">лв</button>
                        <button onclick="setBillCurr('EUR')" id="bEur" class="px-4 rounded-2xl font-bold transition-all">€</button>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div class="bg-white/50 p-3 rounded-3xl shadow-sm border border-white/50">
                    <label class="text-[10px] font-bold text-gray-500 block mb-1">ПЛАТЕНО В ЛВ</label>
                    <input type="number" id="pBgn" placeholder="0.00" class="w-full bg-transparent text-xl font-bold outline-none font-montserrat">
                </div>
                <div class="bg-white/50 p-3 rounded-3xl shadow-sm border border-white/50">
                    <label class="text-[10px] font-bold text-gray-500 block mb-1">ПЛАТЕНО В €</label>
                    <input type="number" id="pEur" placeholder="0.00" class="w-full bg-transparent text-xl font-bold outline-none font-montserrat">
                </div>
            </div>
        </div>

        <div id="error" class="hidden bg-red-500 text-white p-3 rounded-2xl text-center text-sm font-bold shadow-lg animate-bounce">
            Сумата е недостатъчна!
        </div>

        <div id="resArea" class="hidden opacity-0 transition-all duration-700">
            <div class="bg-white/60 rounded-[40px] p-6 text-center shadow-inner">
                <span class="text-[11px] font-bold text-gray-400 block mb-3 uppercase tracking-widest">Ресто</span>
                <div class="flex bg-black/5 rounded-2xl p-1 mb-4">
                    <button onclick="setResCurr('BGN')" id="rBgn" class="flex-1 py-2 rounded-xl font-bold segmented-btn active transition-all">BGN</button>
                    <button onclick="setResCurr('EUR')" id="rEur" class="flex-1 py-2 rounded-xl font-bold segmented-btn transition-all">EUR</button>
                </div>
                <div id="mainValue" class="text-5xl font-bold text-dark-green font-montserrat">0.00 лв</div>
                <div id="secValue" class="text-md text-gray-500 font-medium mt-2">≈ 0.00 €</div>
            </div>
        </div>

        <button id="installBtn" class="hidden w-full bg-app-green py-5 rounded-[25px] font-comfortaa font-bold text-dark-green shadow-xl active:scale-95 transition-transform">
            ИНСТАЛИРАНЕ
        </button>

        <footer class="text-center mt-2">
            <p class="text-[11px] font-bold text-gray-700 tracking-tight">Курс: 1 EUR = 1.95583 BGN</p>
            <p class="text-[10px] text-gray-500 mt-1">© [Нася Цокова]</p>
        </footer>
    </main>

    <script>
        const RATE = 1.95583;
        let billCurr = 'BGN';
        let resCurr = 'BGN';

        // Генериране на шахматна мрежа € и лв
        const bg = document.getElementById('bg-container');
        const rows = 10;
        const cols = 8;
        for (let i = 0; i < rows * cols; i++) {
            const row = Math.floor(i / cols);
            const col = i % cols;
            const sym = document.createElement('div');
            sym.className = 'symbol';
            
            // Стриктно редуване (Шахматен модел)
            if (row % 2 === 0) {
                sym.innerText = col % 2 === 0 ? '€' : 'лв';
            } else {
                sym.innerText = col % 2 === 0 ? 'лв' : '€';
            }
            
            sym.style.animationDelay = `${(i * 0.1)}s`;
            bg.appendChild(sym);
        }

        // Калкулатор
        const billInp = document.getElementById('bill');
        const pBgnInp = document.getElementById('pBgn');
        const pEurInp = document.getElementById('pEur');

        [billInp, pBgnInp, pEurInp].forEach(el => el.addEventListener('input', calculate));

        function setBillCurr(c) {
            billCurr = c;
            document.getElementById('bBgn').className = `px-4 rounded-2xl font-bold transition-all ${c==='BGN'?'bg-app-green text-dark-green shadow-sm':'text-gray-600'}`;
            document.getElementById('bEur').className = `px-4 rounded-2xl font-bold transition-all ${c==='EUR'?'bg-app-green text-dark-green shadow-sm':'text-gray-600'}`;
            calculate();
        }

        function setResCurr(c) {
            resCurr = c;
            document.getElementById('rBgn').classList.toggle('active', c === 'BGN');
            document.getElementById('rEur').classList.toggle('active', c === 'EUR');
            calculate();
        }

        function calculate() {
            const b = parseFloat(billInp.value) || 0;
            const pb = parseFloat(pBgnInp.value) || 0;
            const pe = parseFloat(pEurInp.value) || 0;

            const billBgn = billCurr === 'EUR' ? b * RATE : b;
            const paidBgn = pb + (pe * RATE);
            const diff = paidBgn - billBgn;

            const resArea = document.getElementById('resArea');
            const err = document.getElementById('error');

            if (b > 0 && (pb > 0 || pe > 0)) {
                if (diff < -0.001) {
                    err.classList.remove('hidden');
                    resArea.classList.add('hidden');
                } else {
                    err.classList.add('hidden');
                    resArea.classList.remove('hidden');
                    setTimeout(() => resArea.classList.add('opacity-100'), 10);
                    updateUI(diff);
                }
            } else {
                resArea.classList.add('hidden');
                err.classList.add('hidden');
            }
        }

        function updateUI(diffBgn) {
            const main = document.getElementById('mainValue');
            const sec = document.getElementById('secValue');
            if (resCurr === 'BGN') {
                main.innerText = `${diffBgn.toFixed(
